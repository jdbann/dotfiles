{{- if eq .chezmoi.os "darwin" -}}
#!/bin/bash

which brew || /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)" && eval "$(/opt/homebrew/bin/brew shellenv)"

brew bundle --no-lock --file=/dev/stdin <<EOF
brew "chezmoi"
brew "fish"
brew "mas"
brew "rtx"

cask "alacritty"
cask "raycast"
cask "zed"

mas "Balance: Mindful time tracking", id: 1637311725
mas "Fantastical - Calendar", id: 975937182
mas "Things 3", id: 904280696

tap "homebrew/cask-fonts"
cask "font-iosevka"
EOF

FISH_PATH=$(which fish)
if [ $SHELL != $FISH_PATH ]; then
    grep -qxF $FISH_PATH /etc/shells || sudo sh -c "echo $FISH_PATH >> /etc/shells"
    chsh -s $FISH_PATH
fi
{{ end -}}
